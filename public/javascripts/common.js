"use strict";$(function(){function t(){function t(t){var e=ymaps.templateLayoutFactory.createClass('<div class="item">\n\t\t\t\t<h3>{{properties.title}}</h3>\n\t\t\t\t<h3>{{properties.name}}</h3>\n\t\t\t\t<h3>{{properties.address}}</h3>\n\t\t\t\t<img src="{{properties.img}}">\n\t\t\t\t<p>{{properties.description}}</p>\n\t\t\t\t<a href="#" class="more-info" data-id="{{properties.id}}">Узнать подробнее</a>\n\t\t\t\t<button class="remove-placemark">{{properties.buttonText}}</button>\n\t\t\t\t</div>',{build:function(){e.superclass.build.call(this),$(".remove-placemark").on("click",this.onRemove),$(".more-info").on("click",this.onMoreInfoClick),$(".close-btn").on("click",this.onBtnCloseClick)},clear:function(){$(".remove-placemark").off("click",this.onRemove),$(".more-info").off("click",this.onMoreInfoClick),$(".close-btn").off("click",this.onBtnCloseClick),e.superclass.clear.call(this)},onRemove:function(){alert("Удаление метки с id "+t.id),s.remove(o)},onMoreInfoClick:function(){$(".info__text").html(t.info),$(".info").show()},onBtnCloseClick:function(){$(".info").hide()}}),o=new ymaps.Placemark([t.lon,t.lat],{iconContent:t.markName,title:t.title,name:t.name,address:t.address,description:t.description,img:t.img,id:"",buttonText:"Удалить метку"},{balloonContentLayout:e,preset:"twirl#nightStretchyIcon"});s.add(o)}s.removeAll();for(var e=0;e<c.length;e++)t(c[e]);a.geoObjects.add(s),c.length>"2"&&a.setBounds(s.getBounds())}function e(t){var e=ymaps.geocode(t);return e.then(function(t){var e=t.geoObjects.get(0),o=e?e.geometry.getCoordinates():null;return o})["catch"](function(t){return console.log("err: ",t)})}function o(){localStorage.setItem("objects",JSON.stringify(c))}function n(){var t=localStorage.getItem("objects");t&&(c=JSON.parse(t))}function i(n){n.preventDefault();var i={},r=$(this).serializeArray();r.forEach(function(t){i[t.name]=t.value}),e(i.address).then(function(e){return e?(i.lon=e[0],i.lat=e[1],c.push(i),t(),o(),void n.target.reset()):void alert("Неверный адрес")})}var r=$(".objects-form"),a=void 0,s=void 0;ymaps.ready(function(){a=new ymaps.Map("map",{center:[56.84,60.6],zoom:12,type:"yandex#map"}),s=new ymaps.GeoObjectCollection,t()});var c=[{id:1,lon:56.83,lat:60.6,address:"ул. Куйбышева 55",markName:"Метка 1",title:"Точка",description:"Я РОДИЛСЯ",info:"ЗАКРОЙ МЕНЯ И УХОДИ НЕ ПОРТИ ПЕЙЗАЖ ПЛЗ",img:"https://www.karusel-tv.ru/media/suit/image_in_broadcast/media/image/2011/08/22/60506/24_13140160941.jpg"},{id:2,lon:56.82,lat:60.59,address:"ул. Куйбышева 45",markName:"Метка 2",title:"А я вторая точка",description:"На меня тоже нажали",info:"SCRRRAPAPAPA"}];n(),r.on("submit",i)});
//# sourceMappingURL=../javascripts/common.js.map
